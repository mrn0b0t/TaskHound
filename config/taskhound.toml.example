# TaskHound Configuration File
#
# This file allows you to define default values for TaskHound CLI arguments.
# Place this file at ~/.config/taskhound/taskhound.toml or in your current working directory.
#
# Priority: CLI Args > Env Vars > Local Config > User Config > Defaults

[authentication]
# Default credentials
# username = "svc_taskhound"
# domain = "CORP.LOCAL"
# password = "Password123!"
# hashes = "aad3b435b51404eeaad3b435b51404ee:..." (optional)
# aes_key = "0123456789abcdef..." (AES-128: 32 hex chars, AES-256: 64 hex chars)
# kerberos = true

[target]
# Default domain controller
# dc_ip = "10.0.0.1"
# target = "10.0.0.1"
# targets_file = "targets.txt"
# timeout = 60
# threads = 10  # Parallel workers for multi-target scans (default: 1)
# rate_limit = 5.0  # Max targets per second (default: unlimited)
# dns_tcp = false  # Force DNS over TCP (required for SOCKS proxies/proxychains)

[scanning]
# Default scan options
# offline = "./offline_data"
# include_local = true
# unsaved_creds = true
# opsec = false
# credguard_detect = false
# bh_data = "path/to/data.json"

[cache]
# Caching options for SID resolution, BloodHound queries, and LAPS credentials
# enabled = true
# ttl = 86400  # 24 hours in seconds (applies to all cached data)
# file = "~/.taskhound/cache.db"  # SQLite cache file location

[laps]
# LAPS (Local Administrator Password Solution) settings
# enabled = false  # Enable LAPS authentication mode
# user = "Administrator"  # Override local admin username (default: from msLAPS-Password JSON or 'Administrator')
# force = false  # Force LAPS usage even in OPSEC mode

[credential_validation]
# Credential Validation via Task Scheduler RPC
# Queries task execution history to determine if stored passwords are valid
# WARNING: Creates additional RPC traffic - may be detectable
# enabled = false

[bloodhound]
# BloodHound connection settings
live = false
connector = "http://127.0.0.1:8080"
# username = "admin"
# password = "password"
# api_key = "key_id"
# api_key_id = "key_secret"
timeout = 120
type = "bhce" # or "legacy"
# save_file = "bh_queries.json"

[bloodhound.opengraph]
# OpenGraph generation settings
enabled = true
output_dir = "./opengraph"
no_upload = false
set_icon = true
icon = "clock"
color = "#8B5CF6"

[ldap]
# LDAP SID resolution settings
# no_ldap = false
# user = "svc_ldap"
# password = "password"
# hashes = "LM:NT"
# domain = "domain.local"
# tier0 = false  # Enable LDAP-based Tier-0 detection via group membership queries

[dpapi]
# DPAPI credential decryption settings
# key = "0x51e43225e5b43b25d3768a2ae7f99934cb35d3ea"  # DPAPI_SYSTEM userkey from LSA secrets

[output]
# plain = "./output/plain"
# json = "./output/results.json"
# csv = "./output/results.csv"
# opengraph = "./output/opengraph"
# backup = "./output/xml_backup"
# no_summary = false
# debug = false
# verbose = false
